import React, { useState } from "react";
import {
  View,
  Text,
  TouchableOpacity,
  ScrollView,
  Image,
  Alert,
} from "react-native";
import { Svg, Path, G, Defs, ClipPath, Rect } from "react-native-svg";
import { DeleteConfirmationModal } from "../components/ui/DeleteConfirmationModal";

interface PdfViewerScreenProps {
  pdfId: string;
  pdfName: string;
  onBackPress: () => void;
}

export const PdfViewerScreen: React.FC<PdfViewerScreenProps> = ({
  pdfId,
  pdfName,
  onBackPress,
}) => {
  const [deleteModalVisible, setDeleteModalVisible] = useState(false);

  const handleMorePress = () => {
    setDeleteModalVisible(true);
  };

  const handleDeleteConfirm = () => {
    // Handle PDF deletion
    setDeleteModalVisible(false);
    Alert.alert("Deleted", "PDF has been deleted successfully");
    onBackPress();
  };

  const handleDeleteCancel = () => {
    setDeleteModalVisible(false);
  };

  const handleSharePress = () => {
    Alert.alert("Share", "Share functionality would be implemented here");
  };

  const handleFavoritePress = () => {
    Alert.alert("Favorite", "Favorite functionality would be implemented here");
  };

  const renderMoreIcon = () => (
    <Svg width={24} height={24} viewBox="0 0 24 24" fill="none">
      <Path
        d="M11 18C11 18.5523 11.4477 19 12 19C12.5523 19 13 18.5523 13 18C13 17.4477 12.5523 17 12 17C11.4477 17 11 17.4477 11 18Z"
        stroke="#303030"
        strokeWidth="2"
        strokeLinecap="round"
        strokeLinejoin="round"
      />
      <Path
        d="M11 12C11 12.5523 11.4477 13 12 13C12.5523 13 13 12.5523 13 12C13 11.4477 12.5523 11 12 11C11.4477 11 11 11.4477 11 12Z"
        stroke="#303030"
        strokeWidth="2"
        strokeLinecap="round"
        strokeLinejoin="round"
      />
      <Path
        d="M11 6C11 6.55228 11.4477 7 12 7C12.5523 7 13 6.55228 13 6C13 5.44772 12.5523 5 12 5C11.4477 5 11 5.44772 11 6Z"
        stroke="#303030"
        strokeWidth="2"
        strokeLinecap="round"
        strokeLinejoin="round"
      />
    </Svg>
  );

  const renderShareIcon = () => (
    <Svg width={25} height={24} viewBox="0 0 25 24" fill="none">
      <G clipPath="url(#clip0_1_1154)">
        <Path
          d="M17.4605 16.1435C16.3106 16.1435 15.2745 16.64 14.5555 17.43L8.08806 13.4244C8.26562 12.9705 8.35666 12.4874 8.35647 12C8.35669 11.5126 8.26565 11.0295 8.08806 10.5756L14.5555 6.5698C15.2746 7.35974 16.3106 7.85652 17.4605 7.85652C19.6266 7.85652 21.3888 6.0943 21.3888 3.92816C21.3888 1.76203 19.6266 0 17.4605 0C15.2944 0 13.5322 1.76222 13.5322 3.92835C13.5321 4.41571 13.6231 4.89879 13.8006 5.35269L7.33328 9.35834C6.61422 8.56841 5.57824 8.07162 4.42835 8.07162C2.26222 8.07162 0.5 9.83403 0.5 12C0.5 14.1661 2.26222 15.9283 4.42835 15.9283C5.57819 15.9283 6.61427 15.4317 7.33328 14.6416L13.8006 18.6473C13.6231 19.1012 13.5321 19.5844 13.5322 20.0718C13.5322 22.2377 15.2943 24 17.4605 24C19.6266 24 21.3888 22.2377 21.3888 20.0718C21.3888 17.9057 19.6266 16.1435 17.4605 16.1435ZM14.9646 3.92835C14.9646 2.5521 16.0843 1.43245 17.4605 1.43245C18.8367 1.43245 19.9564 2.5521 19.9564 3.92835C19.9564 5.3046 18.8367 6.42425 17.4605 6.42425C16.0842 6.42425 14.9646 5.30455 14.9646 3.92835ZM4.42835 14.4959C3.05192 14.4959 1.93226 13.3762 1.93226 12C1.93226 10.6238 3.05192 9.50408 4.42835 9.50408C5.8046 9.50408 6.92406 10.6238 6.92406 12C6.92406 13.3762 5.80455 14.4959 4.42835 14.4959ZM14.9646 20.0716C14.9646 18.6954 16.0843 17.5757 17.4605 17.5757C18.8367 17.5757 19.9564 18.6954 19.9564 20.0716C19.9564 21.4478 18.8367 22.5675 17.4605 22.5675C16.0842 22.5675 14.9646 21.4478 14.9646 20.0716V20.0716Z"
          fill="black"
        />
      </G>
      <Defs>
        <ClipPath id="clip0_1_1154">
          <Rect
            width="24"
            height="24"
            fill="white"
            transform="translate(0.5)"
          />
        </ClipPath>
      </Defs>
    </Svg>
  );

  const renderFavoriteIcon = () => (
    <Svg width={25} height={24} viewBox="0 0 25 24" fill="none">
      <G clipPath="url(#clip0_1_1160)">
        <Path
          d="M5.87178 23.0459C5.6088 23.0459 5.3477 22.9638 5.12485 22.8027C4.92217 22.656 4.76709 22.4529 4.67889 22.2188C4.5907 21.9846 4.57328 21.7297 4.62881 21.4858L6.17282 14.6845L0.936559 10.0926C0.748237 9.92823 0.612386 9.71217 0.545908 9.47124C0.479431 9.2303 0.485262 8.97515 0.562675 8.7375C0.639613 8.49999 0.784569 8.29028 0.979572 8.13437C1.17457 7.97847 1.41105 7.88322 1.65967 7.86045L8.58783 7.23142L11.327 0.82124C11.5289 0.350275 11.9889 0.0461426 12.5 0.0461426C13.0111 0.0461426 13.471 0.350275 13.673 0.820162L16.4121 7.23142L23.3392 7.86036C23.8493 7.90629 24.2793 8.25149 24.4373 8.73746C24.5953 9.22347 24.4492 9.7565 24.0643 10.0925L18.8281 14.6836L20.3721 21.4847C20.4852 21.9848 20.2911 22.5019 19.8762 22.8018C19.4622 23.1017 18.9101 23.1248 18.4742 22.8628L12.5 19.2927L6.52584 22.8648C6.32385 22.9847 6.0988 23.0459 5.87178 23.0459ZM12.5 17.7547C12.727 17.7547 12.9519 17.8157 13.154 17.9356L18.7922 21.3078L17.335 14.8885C17.284 14.6641 17.2946 14.4302 17.3658 14.2113C17.4369 13.9925 17.5659 13.797 17.7391 13.6455L22.6833 9.30949L16.142 8.71552C15.9118 8.69491 15.6916 8.61207 15.5049 8.47588C15.3181 8.33969 15.172 8.15528 15.082 7.94239L12.5 1.89321L9.91485 7.94328C9.73283 8.37431 9.32777 8.67042 8.85793 8.71346L2.31575 9.30747L7.25978 13.6435C7.61388 13.9536 7.76876 14.4296 7.66386 14.8876L6.20779 21.3067L11.8459 17.9356C12.0479 17.8157 12.273 17.7547 12.5 17.7547ZM8.53491 7.35536C8.53491 7.35536 8.53491 7.35644 8.53383 7.35737L8.53491 7.35536ZM16.4631 7.35241L16.4642 7.35442C16.4642 7.35334 16.4642 7.35334 16.463 7.35241H16.4631Z"
          fill="black"
        />
      </G>
      <Defs>
        <ClipPath id="clip0_1_1160">
          <Rect
            width="24"
            height="24"
            fill="white"
            transform="translate(0.5)"
          />
        </ClipPath>
      </Defs>
    </Svg>
  );

  const renderDeleteIcon = () => (
    <Svg width={25} height={24} viewBox="0 0 25 24" fill="none">
      <Path
        d="M16.3401 22.25H8.66009C7.89171 22.2389 7.15584 21.9381 6.59963 21.4079C6.04343 20.8776 5.70788 20.157 5.66009 19.39L4.75009 5.55C4.74542 5.44966 4.7607 5.34938 4.79502 5.25498C4.82935 5.16057 4.88206 5.07391 4.95009 5C5.02017 4.9234 5.10503 4.86177 5.19954 4.81881C5.29406 4.77584 5.39629 4.75244 5.50009 4.75H19.5001C19.6029 4.74977 19.7047 4.7707 19.7991 4.81148C19.8936 4.85226 19.9786 4.91202 20.0489 4.98704C20.1193 5.06207 20.1734 5.15077 20.208 5.24761C20.2426 5.34446 20.2569 5.44739 20.2501 5.55L19.3801 19.39C19.3318 20.1638 18.9906 20.8902 18.4259 21.4214C17.8612 21.9527 17.1154 22.249 16.3401 22.25ZM6.34009 6.25L7.11009 19.3C7.13553 19.6935 7.31 20.0625 7.59797 20.3319C7.88594 20.6013 8.26576 20.7508 8.66009 20.75H16.3401C16.7337 20.7485 17.1122 20.5982 17.3997 20.3292C17.6872 20.0603 17.8623 19.6927 17.8901 19.3L18.7001 6.3L6.34009 6.25Z"
        fill="black"
      />
      <Path
        d="M21.5 6.25H3.5C3.30109 6.25 3.11032 6.17098 2.96967 6.03033C2.82902 5.88968 2.75 5.69891 2.75 5.5C2.75 5.30109 2.82902 5.11032 2.96967 4.96967C3.11032 4.82902 3.30109 4.75 3.5 4.75H21.5C21.6989 4.75 21.8897 4.82902 22.0303 4.96967C22.171 5.11032 22.25 5.30109 22.25 5.5C22.25 5.69891 22.171 5.88968 22.0303 6.03033C21.8897 6.17098 21.6989 6.25 21.5 6.25Z"
        fill="black"
      />
      <Path
        d="M15.5 6.25H9.5C9.30189 6.24741 9.11263 6.16756 8.97253 6.02747C8.83244 5.88737 8.75259 5.69811 8.75 5.5V3.7C8.76268 3.18682 8.97219 2.69816 9.33518 2.33518C9.69816 1.97219 10.1868 1.76268 10.7 1.75H14.3C14.8217 1.76305 15.3177 1.97951 15.682 2.35317C16.0463 2.72684 16.2502 3.22812 16.25 3.75V5.5C16.2474 5.69811 16.1676 5.88737 16.0275 6.02747C15.8874 6.16756 15.6981 6.24741 15.5 6.25ZM10.25 4.75H14.75V3.75C14.75 3.63065 14.7026 3.51619 14.6182 3.4318C14.5338 3.34741 14.4193 3.3 14.3 3.3H10.7C10.5807 3.3 10.4662 3.34741 10.3818 3.4318C10.2974 3.51619 10.25 3.63065 10.25 3.75V4.75ZM15.5 18.25C15.3019 18.2474 15.1126 18.1676 14.9725 18.0275C14.8324 17.8874 14.7526 17.6981 14.75 17.5V9.5C14.75 9.30109 14.829 9.11032 14.9697 8.96967C15.1103 8.82902 15.3011 8.75 15.5 8.75C15.6989 8.75 15.8897 8.82902 16.0303 8.96967C16.171 9.11032 16.25 9.30109 16.25 9.5V17.5C16.2474 17.6981 16.1676 17.8874 16.0275 18.0275C15.8874 18.1676 15.6981 18.2474 15.5 18.25ZM9.5 18.25C9.30189 18.2474 9.11263 18.1676 8.97253 18.0275C8.83244 17.8874 8.75259 17.6981 8.75 17.5V9.5C8.75 9.30109 8.82902 9.11032 8.96967 8.96967C9.11032 8.82902 9.30109 8.75 9.5 8.75C9.69891 8.75 9.88968 8.82902 10.0303 8.96967C10.171 9.11032 10.25 9.30109 10.25 9.5V17.5C10.2474 17.6981 10.1676 17.8874 10.0275 18.0275C9.88737 18.1676 9.69811 18.2474 9.5 18.25ZM12.5 18.25C12.3019 18.2474 12.1126 18.1676 11.9725 18.0275C11.8324 17.8874 11.7526 17.6981 11.75 17.5V9.5C11.75 9.30109 11.829 9.11032 11.9697 8.96967C12.1103 8.82902 12.3011 8.75 12.5 8.75C12.6989 8.75 12.8897 8.82902 13.0303 8.96967C13.171 9.11032 13.25 9.30109 13.25 9.5V17.5C13.2474 17.6981 13.1676 17.8874 13.0275 18.0275C12.8874 18.1676 12.6981 18.2474 12.5 18.25Z"
        fill="black"
      />
    </Svg>
  );

  return (
    <View style={{ flex: 1, backgroundColor: "#FFF" }}>
      {/* Status Bar */}
      <View
        style={{
          width: "100%",
          height: 44,
          paddingHorizontal: 24,
          paddingTop: 13,
          flexDirection: "row",
          justifyContent: "space-between",
          alignItems: "center",
        }}
      >
        <Text
          style={{
            fontSize: 14,
            fontWeight: "400",
            color: "#181818",
            fontFamily: "Prompt",
          }}
        >
          5:13
        </Text>

        <View style={{ flexDirection: "row", alignItems: "center", gap: 5 }}>
          {/* Mobile Signal */}
          <Svg width={17} height={12} viewBox="0 0 18 12" fill="none">
            <Path
              d="M9.771 3C9.771 2.44772 10.1971 2 10.7227 2H11.6744C12.2 2 12.6261 2.44772 12.6261 3V11C12.6261 11.5523 12.2 12 11.6744 12H10.7227C10.1971 12 9.771 11.5523 9.771 11V3Z"
              fill="#181818"
            />
            <Path
              d="M14.5295 1C14.5295 0.447715 14.9556 0 15.4813 0H16.433C16.9586 0 17.3847 0.447715 17.3847 1V11C17.3847 11.5523 16.9586 12 16.433 12H15.4813C14.9556 12 14.5295 11.5523 14.5295 11V1Z"
              fill="#181818"
            />
            <Path
              d="M5.01245 6.5C5.01245 5.94772 5.43855 5.5 5.96416 5.5H6.91587C7.44149 5.5 7.86758 5.94772 7.86758 6.5V11C7.86758 11.5523 7.44149 12 6.91587 12H5.96416C5.43855 12 5.01245 11.5523 5.01245 11V6.5Z"
              fill="#181818"
            />
            <Path
              d="M0.253906 9C0.253906 8.44772 0.680001 8 1.20562 8H2.15733C2.68294 8 3.10903 8.44772 3.10903 9V11C3.10903 11.5523 2.68294 12 2.15733 12H1.20562C0.680001 12 0.253906 11.5523 0.253906 11V9Z"
              fill="#181818"
            />
          </Svg>

          {/* WiFi */}
          <Svg width={16} height={11} viewBox="0 0 17 11" fill="none">
            <Path
              d="M6.2461 8.2905C7.59261 7.1513 9.56458 7.15139 10.9111 8.2905C10.9788 8.35175 11.0186 8.43847 11.0205 8.52976C11.0224 8.62112 10.9861 8.70891 10.9209 8.77292L8.81251 10.9018C8.75078 10.9643 8.66691 11.0004 8.57911 11.0005C8.49118 11.0005 8.40655 10.9644 8.34473 10.9018L6.23536 8.77292C6.1705 8.70891 6.1348 8.6209 6.13673 8.52976C6.13869 8.43844 6.17833 8.35172 6.2461 8.2905ZM3.39551 5.74265C6.2968 3.04291 10.7902 3.04282 13.6914 5.74265C13.7568 5.80585 13.7939 5.89293 13.7949 5.98386C13.7959 6.07496 13.7605 6.16337 13.6963 6.228L12.4766 7.45945C12.351 7.58519 12.1484 7.58857 12.0195 7.46628C11.0668 6.6032 9.8273 6.12441 8.542 6.12449C7.25756 6.12503 6.01948 6.60378 5.06739 7.46628C4.93853 7.58875 4.73499 7.58526 4.60938 7.45945L3.39063 6.228C3.32642 6.16357 3.29126 6.0758 3.292 5.98484C3.29286 5.8937 3.32998 5.80596 3.39551 5.74265ZM0.547858 3.19968C4.99771 -1.06659 12.0179 -1.06653 16.4678 3.19968C16.5322 3.26306 16.5688 3.34953 16.5693 3.43991C16.5699 3.53026 16.5343 3.617 16.4707 3.68113L15.25 4.91355C15.1243 5.03969 14.9206 5.04159 14.793 4.91745C13.0976 3.30495 10.8471 2.40486 8.50782 2.40476C6.16843 2.40487 3.91817 3.30495 2.22266 4.91745C2.09508 5.04171 1.89117 5.03995 1.76563 4.91355L0.544929 3.68113C0.481331 3.61696 0.445718 3.53027 0.446296 3.43991C0.44689 3.34954 0.483414 3.26301 0.547858 3.19968Z"
              fill="#181818"
            />
          </Svg>

          {/* Battery */}
          <Svg width={24} height={13} viewBox="0 0 25 13" fill="none">
            <Path
              fillRule="evenodd"
              clipRule="evenodd"
              d="M0.630859 4C0.630859 1.79086 2.42172 0 4.63086 0H18.4838C20.693 0 22.4839 1.79086 22.4839 4V9C22.4839 11.2091 20.693 13 18.4839 13H4.63086C2.42173 13 0.630859 11.2091 0.630859 9V4Z"
              fill="#181818"
            />
            <Path
              d="M0.630859 4C0.630859 1.79086 2.42172 0 4.63086 0H16.5239V13H4.63086C2.42172 13 0.630859 11.2091 0.630859 9V4Z"
              fill="#181818"
            />
            <Path
              d="M23.4775 4.80762V8.86564C24.2885 8.52195 24.8158 7.72243 24.8158 6.83663C24.8158 5.95083 24.2885 5.15131 23.4775 4.80762Z"
              fill="#181818"
            />
          </Svg>
        </View>
      </View>

      {/* Header */}
      <View
        style={{
          width: "100%",
          height: 64,
          paddingHorizontal: 24,
          paddingVertical: 10,
          backgroundColor: "rgba(255, 255, 255, 0.50)",
          justifyContent: "center",
        }}
      >
        <View
          style={{
            flexDirection: "row",
            justifyContent: "space-between",
            alignItems: "center",
          }}
        >
          <View style={{ flexDirection: "row", alignItems: "center", gap: 8 }}>
            {/* Back Button */}
            <TouchableOpacity onPress={onBackPress}>
              <Svg width={24} height={24} viewBox="0 0 24 24" fill="none">
                <G clipPath="url(#clip0_3_426)">
                  <Path
                    d="M13.8302 19C13.6808 19.0005 13.5332 18.9676 13.3982 18.9035C13.2632 18.8395 13.1443 18.7461 13.0502 18.63L8.22016 12.63C8.07308 12.4511 7.99268 12.2267 7.99268 11.995C7.99268 11.7634 8.07308 11.539 8.22016 11.36L13.2202 5.36003C13.3899 5.15581 13.6338 5.02739 13.8982 5.00301C14.1627 4.97863 14.4259 5.06029 14.6302 5.23003C14.8344 5.39977 14.9628 5.64368 14.9872 5.90811C15.0116 6.17253 14.9299 6.43581 14.7602 6.64003L10.2902 12L14.6102 17.36C14.7324 17.5068 14.8101 17.6856 14.834 17.8751C14.8579 18.0647 14.827 18.2571 14.7449 18.4296C14.6629 18.6021 14.5331 18.7475 14.371 18.8486C14.2089 18.9497 14.0212 19.0023 13.8302 19Z"
                    fill="#262626"
                  />
                </G>
                <Defs>
                  <ClipPath id="clip0_3_426">
                    <Rect width="24" height="24" fill="white" />
                  </ClipPath>
                </Defs>
              </Svg>
            </TouchableOpacity>

            {/* PDF Name */}
            <Text
              style={{
                fontSize: 18,
                fontWeight: "400",
                color: "#303030",
                fontFamily: "Inter",
                lineHeight: 30,
              }}
            >
              {pdfName}
            </Text>
          </View>

          <TouchableOpacity onPress={handleMorePress}>
            {renderMoreIcon()}
          </TouchableOpacity>
        </View>
      </View>

      {/* PDF Content */}
      <ScrollView style={{ flex: 1, paddingHorizontal: 24, paddingTop: 61 }}>
        <Image
          source={{
            uri: "https://cdn.builder.io/api/v1/image/assets/TEMP/ed3023680d0a9ef998f64e29c16b27e0dffe8750?width=690",
          }}
          style={{
            width: "100%",
            height: 632,
            resizeMode: "contain",
          }}
        />
      </ScrollView>

      {/* Bottom Actions */}
      <View
        style={{
          width: "100%",
          height: 64,
          paddingHorizontal: 40,
          paddingVertical: 10,
          justifyContent: "center",
        }}
      >
        <View
          style={{
            flexDirection: "row",
            justifyContent: "space-between",
            alignItems: "center",
          }}
        >
          {/* Share */}
          <TouchableOpacity
            style={{
              alignItems: "center",
              gap: 5,
              width: 57,
            }}
            onPress={handleSharePress}
          >
            {renderShareIcon()}
            <Text
              style={{
                fontSize: 10,
                fontWeight: "400",
                color: "#303030",
                fontFamily: "Archivo",
                lineHeight: 20,
              }}
            >
              Share
            </Text>
          </TouchableOpacity>

          {/* Favorite */}
          <TouchableOpacity
            style={{
              alignItems: "center",
              gap: 5,
              width: 57,
            }}
            onPress={handleFavoritePress}
          >
            {renderFavoriteIcon()}
            <Text
              style={{
                fontSize: 10,
                fontWeight: "400",
                color: "#303030",
                fontFamily: "Archivo",
                lineHeight: 20,
              }}
            >
              Favorite
            </Text>
          </TouchableOpacity>

          {/* Delete */}
          <TouchableOpacity
            style={{
              alignItems: "center",
              gap: 5,
              width: 57,
            }}
            onPress={() => setDeleteModalVisible(true)}
          >
            {renderDeleteIcon()}
            <Text
              style={{
                fontSize: 10,
                fontWeight: "400",
                color: "#303030",
                fontFamily: "Archivo",
                lineHeight: 20,
              }}
            >
              Delete
            </Text>
          </TouchableOpacity>
        </View>
      </View>

      {/* Bottom Bar */}
      <View
        style={{
          width: "100%",
          height: 20,
          paddingHorizontal: 10,
          paddingVertical: 5,
          borderRadius: 0,
          borderBottomLeftRadius: 32,
          borderBottomRightRadius: 32,
          justifyContent: "center",
          alignItems: "center",
        }}
      >
        <View
          style={{
            width: 150,
            height: 4,
            borderRadius: 16,
            backgroundColor: "#545454",
          }}
        />
      </View>

      {/* Delete Confirmation Modal */}
      <DeleteConfirmationModal
        visible={deleteModalVisible}
        onCancel={handleDeleteCancel}
        onConfirm={handleDeleteConfirm}
        itemType="PDF"
      />
    </View>
  );
};
